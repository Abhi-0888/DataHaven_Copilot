You are working on DataHeaven Copilot, a verifiable intelligence platform that:

analyzes datasets with AI

calculates transparent trust scores

logs lifecycle events

records AI memory proofs

simulates decentralized storage verification

The existing MVP already includes:

âœ… Dataset upload
âœ… Analysis + insights
âœ… Trust scoring
âœ… Verification timeline
âœ… AI memory ledger
âœ… Audit logs

Your task is to refactor, expand, and polish the system into a production-structured architecture while keeping the app fully functional.

ğŸ—ï¸ TARGET ARCHITECTURE

Implement a modular structure with clear separation of concerns.

ğŸ“‚ SERVER STRUCTURE
server/
 â”œâ”€â”€ app.ts
 â”œâ”€â”€ routes/
 â”‚    dataset.routes.ts
 â”‚    verification.routes.ts
 â”‚    ledger.routes.ts
 â”‚    trust.routes.ts
 â”‚    events.routes.ts
 â”‚
 â”œâ”€â”€ controllers/
 â”‚    dataset.controller.ts
 â”‚    verification.controller.ts
 â”‚    ledger.controller.ts
 â”‚    trust.controller.ts
 â”‚    events.controller.ts
 â”‚
 â”œâ”€â”€ services/
 â”‚    dataset.service.ts
 â”‚    analysis.service.ts
 â”‚    trust.service.ts
 â”‚    verification.service.ts
 â”‚    ledger.service.ts
 â”‚    timeline.service.ts
 â”‚    event.service.ts
 â”‚
 â”œâ”€â”€ repositories/
 â”‚    dataset.repo.ts
 â”‚    ledger.repo.ts
 â”‚    event.repo.ts
 â”‚    version.repo.ts
 â”‚
 â”œâ”€â”€ middleware/
 â”‚    errorHandler.ts
 â”‚    requestLogger.ts
 â”‚
 â”œâ”€â”€ utils/
 â”‚    hash.ts
 â”‚    scoring.ts
 â”‚
 â””â”€â”€ config/
      database.ts
ğŸ“‚ CLIENT STRUCTURE
client/src/
 â”œâ”€â”€ pages/
 â”‚    Dashboard.tsx
 â”‚    DatasetDetails.tsx
 â”‚    Verification.tsx
 â”‚    Ledger.tsx
 â”‚    Lineage.tsx
 â”‚    Audit.tsx
 â”‚
 â”œâ”€â”€ components/
 â”‚    TrustBreakdown.tsx
 â”‚    VerificationTimeline.tsx
 â”‚    MemoryLedger.tsx
 â”‚    EventLogTable.tsx
 â”‚    LineageGraph.tsx
 â”‚    ProofBadge.tsx
 â”‚
 â”œâ”€â”€ features/
 â”‚    dataset/
 â”‚    verification/
 â”‚    ledger/
 â”‚    lineage/
 â”‚
 â”œâ”€â”€ services/
 â”‚    api.ts
 â”‚    verification.ts
 â”‚
 â””â”€â”€ hooks/
ğŸ—„ï¸ DATABASE SCHEMA UPDATES

Ensure these tables exist and migrations are created.

datasets (update)

Add fields:

completeness_score FLOAT

freshness_score FLOAT

consistency_score FLOAT

schema_score FLOAT

verification_score FLOAT

verification_events

id UUID

dataset_id UUID

event_type TEXT

metadata JSONB

created_at TIMESTAMP

ai_memory_ledger

id UUID

dataset_id UUID

insight_text TEXT

insight_hash TEXT

dataset_version INT

verified BOOLEAN

created_at TIMESTAMP

dataset_versions

id UUID

dataset_id UUID

version_number INT

parent_version INT

file_hash TEXT

created_at TIMESTAMP

system_events

id UUID

dataset_id UUID

event_type TEXT

actor TEXT

metadata JSONB

created_at TIMESTAMP

âš™ï¸ BACKEND FEATURES TO IMPLEMENT
1ï¸âƒ£ Trust Score Breakdown Service

Create trust.service.ts

Responsibilities:

compute individual scores

calculate final trust score

update dataset record

Formula:

Trust =
0.3 completeness
0.25 freshness
0.2 consistency
0.15 schema
0.1 verification
2ï¸âƒ£ Verification Timeline Service

Create timeline.service.ts

Functions:

addEvent(datasetId, eventType, metadata)

getTimeline(datasetId)

3ï¸âƒ£ AI Memory Ledger Service

Create ledger.service.ts

Functions:

createLedgerEntry(datasetId, insight, version)

hash insight

mark verified

4ï¸âƒ£ Dataset Versioning

Create version.repo.ts

Functions:

createVersion

getVersions

link parent

5ï¸âƒ£ System Event Logger

Create event.service.ts

Functions:

logEvent

fetchEvents

ğŸ”Œ API ENDPOINTS TO ADD
Timeline

GET /api/datasets/:id/timeline

Ledger

GET /api/datasets/:id/ledger

Trust Breakdown

GET /api/datasets/:id/trust

Versions

GET /api/datasets/:id/versions

Events

GET /api/datasets/:id/events

ğŸ¨ FRONTEND FEATURES TO BUILD
Trust Breakdown Component

Show progress bars for each metric.

Verification Timeline Component

Vertical timeline UI showing events.

Memory Ledger Page

List insights with hash + status.

Lineage Graph

Show dataset version history.

Audit Log Table

Display system events.

ğŸ” SECURITY & VALIDATION

Implement:

input validation

file type validation

error middleware

consistent API responses

ğŸ§ª TESTING TASKS

Add:

service unit tests

API endpoint tests

dataset upload integration test

ğŸª™ DATAHAVEN SIMULATION LAYER

Create verification.service.ts

Simulate:

storage proof generation

verification check

network label â€œDataHaven Testnetâ€

ğŸš€ UX POLISH

Add:

âœ” proof verified animation
âœ” copy hash button
âœ” loading states
âœ” empty states

ğŸ“˜ DOCUMENTATION TASK

Update README with:

architecture diagram

database schema

API list

demo flow

ğŸ§  SUCCESS CRITERIA

The implementation is complete when:

âœ” datasets show trust breakdown
âœ” timeline displays lifecycle
âœ” ledger shows AI proofs
âœ” lineage graph renders
âœ” audit logs visible
âœ” API modular
âœ” no breaking changes

âš ï¸ IMPORTANT RULES

Do not remove existing functionality

Maintain backward compatibility

Use TypeScript types everywhere

Keep services reusable

Write clean, readable code

ğŸ§­ FINAL OUTPUT EXPECTATION

After completing tasks:

1ï¸âƒ£ App runs without errors
2ï¸âƒ£ All new pages accessible
3ï¸âƒ£ Database migrations applied
4ï¸âƒ£ UI matches existing design language
5ï¸âƒ£ Features demonstrable in demo